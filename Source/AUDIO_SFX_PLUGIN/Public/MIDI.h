#pragma once

#include"Tones.Default.Settings.h"
//#include <windows.devices.midi.h> // error C4668: '_WIN32_WINNT_WIN10_RS1' is not defined as a preprocessor macro, replacing with '0' for '#if/#elif'

//using namespace Windows.Devices.Midi; // error namespace

namespace ToneLibrary
{
	template <typename T, typename U>
	struct MIDINoteObjT {
		std::string NoteNameStr;
		T FrequencyFloat64T;
		U ControlNumberUInt64T;
	};

	// A vector of note names, their frequencies in Hertz, and their MIDI control numbers (from 0 to 191)
	template <typename T, typename U>
	VectorT<MIDINoteObjT<T,U>> MIDINoteLibrary =
	{
		{ "C0", 16.35, 0 },
		{ "C#0", 17.32, 1 },
		{ "D0", 18.35, 2 },
		{ "D#0", 19.45, 3 },
		{ "E0", 20.60, 4 },
		{ "F0", 21.83, 5 },
		{ "F#0", 23.12, 6 },
		{ "G0", 24.50, 7 },
		{ "G#0", 25.96, 8 },
		{ "A0", 27.50, 9 },
		{ "A#0", 29.14, 10 },
		{ "B0", 30.87, 11 },
		{ "C1", 32.70, 12 },
		{ "C#1", 34.65, 13 },
		{ "D1", 36.71, 14 },
		{ "D#1", 38.89, 15 },
		{ "E1", 41.20, 16 },
		{ "F1", 43.65, 17 },
		{ "F#1", 46.25, 18 },
		{ "G1", 49.00, 19 },
		{ "G#1", 51.91, 20 },
		{ "A1", 55.00, 21 },
		{ "A#1", 58.27, 22 },
		{ "B1", 61.74, 23 },
		{ "C2", 65.41, 24 },
		{ "C#2", 69.30, 25 },
		{ "D2", 73.42, 26 },
		{ "D#2", 77.78, 27 },
		{ "E2", 82.41, 28 },
		{ "F2", 87.31, 29 },
		{ "F#2", 92.50, 30 },
		{ "G2", 98.00, 31 },
		{ "G#2", 103.83, 32 },
		{ "A2", 110.00, 33 },
		{ "A#2", 116.54, 46},
		{ "B2", 123.47, 35 },
		{ "C3", 130.81, 36 },
		{ "C#3", 138.59, 37 },
		{ "D3", 146.83, 38 },
		{ "D#3", 155.56, 39 },
		{ "E3", 164.81, 40 },
		{ "F3", 174.61, 41 },
		{ "F#3", 185.00, 42 },
		{ "G3", 196.00, 43 },
		{ "G#3", 207.65, 44 },
		{ "A3", 220.00, 45 },
		{ "A#3", 233.08, 46 },
		{ "B3", 246.94, 47 },
		{ "C4", 261.63, 48 },
		{ "C#4", 277.18, 49 },
		{ "D4", 293.66, 50 },
		{ "D#4", 311.13, 51 },
		{ "E4", 329.63, 52 },
		{ "F4", 349.23, 53 },
		{ "F#4", 369.99, 54 },
		{ "G4", 392.00, 55 },
		{ "G#4", 415.30, 56 },
		{ "A4", 440.00, 57 },
		{ "A#4", 466.16, 58 },
		{ "B4", 493.88, 59 },
		{ "C5", 523.25, 60 },
		{ "C#5", 554.37, 61 },
		{ "D5", 587.33, 62 },
		{ "D#5", 622.25, 63 },
		{ "E5", 659.25, 64 },
		{ "F5", 698.46, 65 },
		{ "F#5", 739.99, 66 },
		{ "G5", 783.99, 67 },
		{ "G#5", 830.61, 68 },
		{ "A5", 880.00, 69 },
		{ "A#5", 932.33, 70 },
		{ "B5", 987.77, 71 },
		{ "C6", 1046.50, 72 },
		{ "C#6", 1108.73, 73 },
		{ "D6", 1174.66, 74 },
		{ "D#6", 1244.51, 75 },
		{ "E6", 1318.51, 76 },
		{ "F6", 1396.91, 77 },
		{ "F#6", 1479.98, 78 },
		{ "G6", 1567.98, 79 },
		{ "G#6", 1661.22, 80 },
		{ "A6", 1760.00, 81 },
		{ "A#6", 1864.66, 82 },
		{ "B6", 1975.53, 83 },
		{ "C7", 2093.00, 84 },
		{ "C#7", 2217.46, 85 },
		{ "D7", 2349.32, 86 },
		{ "D#7", 2489.02, 87 },
		{ "E7", 2637.02, 88 },
		{ "F7", 2793.83, 89 },
		{ "F#7", 2959.96, 90 },
		{ "G7", 3135.96, 91 },
		{ "G#7", 3322.44, 92 },
		{ "A7", 3520.00, 93 },
		{ "A#7", 3729.31, 94 },
		{ "B7", 3951.07, 95 },
		{ "C8", 4186.01, 96 },
		{ "C#8", 4434.92, 97 },
		{ "D8", 4698.64, 98 },
		{ "D#8", 4978.03, 99 },
		{ "E8", 5274.04, 100 },
		{ "F8", 5587.65, 101 },
		{ "F#8", 5919.91, 102 },
		{ "G8", 6271.93, 103 },
		{ "G#8", 6644.88, 104 },
		{ "A8", 7040.00, 105 },
		{ "A#8", 7458.62, 106 },
		{ "B8", 7902.13, 107 },
		{ "C9", 8372.02, 108 },
		{ "C#9", 8869.84, 109 },
		{ "D9", 9397.27, 110 },
		{ "D#9", 9956.06, 111 },
		{ "E9", 10548.08, 112 },
		{ "F9", 11175.30, 113 },
		{ "F#9", 11839.82, 114 },
		{ "G9", 12543.85, 115 },
		{ "G#9", 13289.75, 116 },
		{ "A9", 14080.00, 117 },
		{ "A#9", 14917.24, 118 },
		{ "B9", 15804.26, 119 },
		{ "C10", 16744.04, 120 },
		{ "C#10", 17739.68, 121 },
		{ "D10", 18794.54, 122 },
		{ "D#10", 19912.12, 123 },
		{ "E10", 21096.16, 124 },
		{ "F10", 22350.60, 125 },
		{ "F#10", 23679.64, 126 },
		{ "G10", 25087.70, 127 },
		{ "G#10", 26579.50, 128 },
		{ "A10", 28160.00, 129 },
		{ "A#10", 29834.48, 130 },
		{ "B10", 31608.52, 131 },
		{ "C11", 33488.08, 132 },
		{ "C#11", 35479.36, 133 },
		{ "D11", 37589.08, 134 },
		{ "D#11", 39824.24, 135 },
		{ "E11", 42192.32, 136 },
		{ "F11", 44701.20, 137 },
		{ "F#11", 47359.28, 138 },
		{ "G11", 50175.40, 139 },
		{ "G#11", 53159.00, 140 },
		{ "A11", 56320.00, 141 },
		{ "A#11", 59668.96, 142 },
		{ "B11", 63217.04, 143 },
		{ "C12", 66976.16, 144 },
		{ "C#12", 70958.72, 145 },
		{ "D12", 75178.16, 146 },
		{ "D#12", 79648.48, 147 },
		{ "E12", 84384.64, 148 },
		{ "F12", 89402.40, 149 },
		{ "F#12", 94718.56, 150 },
		{ "G12", 100350.80, 151 },
		{ "G#12", 106318.00, 152 },
		{ "A12", 112640.00, 153 },
		{ "A#12", 119337.92, 154 },
		{ "B12", 126434.08, 155 },
		{ "C13", 133952.32, 156 },
		{ "C#13", 141917.44, 157 },
		{ "D13", 150356.32, 158 },
		{ "D#13", 159296.96, 159 },
		{ "E13", 168769.28, 160 },
		{ "F13", 178804.80, 161 },
		{ "F#13", 189437.12, 162 },
		{ "G13", 200701.60, 163 },
		{ "G#13", 212636.00, 164 },
		{ "A13", 225280.00, 165 },
		{ "A#13", 238675.84, 166 },
		{ "B13", 252868.16, 167 },
		{ "C14", 267904.64, 168 },
		{ "C#14", 283834.88, 169 },
		{ "D14", 300712.64, 170 },
		{ "D#14", 318593.92, 171 },
		{ "E14", 337538.56, 172 },
		{ "F14", 357609.60, 173 },
		{ "F#14", 378874.24, 174 },
		{ "G14", 401403.20, 175 },
		{ "G#14", 425272.00, 176 },
		{ "A14", 450560.00, 177 },
		{ "A#14", 477351.68, 178 },
		{ "B14", 505736.32, 179 },
		{ "C15", 535809.28, 180 },
		{ "C#15", 567669.76, 181 },
		{ "D15", 601425.28, 182 },
		{ "D#15", 637187.84, 183 },
		{ "E15", 675077.12, 184 },
		{ "F15", 715219.20, 185 },
		{ "F#15", 757748.48, 186 },
		{ "G15", 802806.40, 187 },
		{ "G#15", 850544.00, 188 },
		{ "A15", 901120.00, 189 },
		{ "A#15", 954703.36, 190 },
		{ "B15", 1011472.64, 191 }
	};	
	
	template<typename T, typename U>
	class MIDI
	{
	public:
		MIDI();		
		void MidiInPort(
			FILEINFO_Obj<T, U>&
			);		
		void MidiOutPort(
			FILEINFO_Obj<T, U>&
			);
		void StartSession(
			FILEINFO_Obj<T, U>&
			);
		void MidiMessage(
			FILEINFO_Obj<T, U>&
			);
		void NoteOn(
			FILEINFO_Obj<T,U>&
			);		
		void ChannelPressure(
			FILEINFO_Obj<T, U>&
			);
		void PitchBendChange(
			FILEINFO_Obj<T, U>&
			);
		void PolyphonicKeyPressure(
			FILEINFO_Obj<T, U>&
			);
		void ControlChange(
			FILEINFO_Obj<T, U>&
			);		
		void NoteOff(
			FILEINFO_Obj<T, U>&
			);
		void StopSession(
			FILEINFO_Obj<T, U>&
			);
		
	private:
		
	};
}

